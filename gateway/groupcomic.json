{
  "$schema": "https://www.krakend.io/schema/v3.json",
  "version": 3,
  "timeout": "10s",
  "cache_ttl": "300ms",
  "output_encoding": "json",
  "name": "projectf",
  "port": 8080,
  "endpoints": [
    {
      "endpoint": "/comic/characters",
      "method": "GET",
      "timeout": "1000s",
      "backend": [
        {
          "url_pattern": "/b",
          "group": "sequence0"
        },
        {
          "url_pattern": "/b",
          "group": "sequence1",
          "extra_config": {
            "validation/cel": [
              {
                "check_expr": "sequence0.resp_data.datatype == 'Characters'"
              }
            ]
          }
        },
        {
          "host": [
            "http://localhost:8080"
          ],
          "url_pattern": "/b",
          "group": "sequence2",
          "allow": [
            "datatype",
            "rawdata"
          ],
          "extra_config": {
            "validation/cel": [
              {
                "check_expr": "resp_data.datatype == 'Character'"
              }
            ]
          }
        }
      ],
      "extra_config": {
        "proxy": {
          "sequential": true
        }
      }
    },
    {
      "endpoint": "/b",
      "timeout": "200ms",
      "method": "GET",
      "backend": [
        {
          "host": [
            "amqp://guest:guest@localhost:5672"
          ],
          "disable_host_sanitize": true,
          "extra_config": {
            "backend/amqp/consumer": {
              "name": "queue-1",
              "exchange": "producer-q-exchange",
              "durable": true,
              "delete": false,
              "no_wait": true,
              "no_local": false,
              "routing_key": [
                "1"
              ],
              "prefetch_count": 1,
              "auto_ack": false,
              "backoff_strategy": "exponential-jitter"
            }
          }
        }
      ]
    }
  ]
}